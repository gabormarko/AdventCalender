<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Advent Calendar</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#b30000">

  <!-- iOS support -->
  <link rel="apple-touch-icon" href="app-icon-me.png">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
  <style>

  .title-bg {
    display: flex;
    justify-content: center;
    align-items: center;
    background: url('wood5.jpg') center center/cover no-repeat;
    border-radius: 14px;
    margin-top: -20px;
    margin-bottom: 2px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.13);
    width: calc((4 * 80px + 3 * 8px)*1.1); /* match .calendar grid width */
    max-width: 100vw;
    height: 120px; 
    padding: 0;
    background-size: cover;
    background-repeat: no-repeat;
  }
    .title-bg h1 {
      margin: 0;
      line-height: 1.1;
      width: 100%;
      text-align: center;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      height: 100%;
      color: #fff;
      font-size: 1.56em;
      text-shadow:
        -1.3px -1.3px 0 #2d1807,
         1.3px -1.3px 0 #2d1807,
        -1.3px  1.3px 0 #2d1807,
         1.3px  1.3px 0 #2d1807,
         0px   1.2px 0 #2d1807,
         1.3px  0px 0 #2d1807,
        -1.3px  0px 0 #2d1807,
         0px  -1.3px 0 #2d1807,
         0 0 4px #2d1807;
      padding-bottom: 40px;
    }
                        @keyframes scaleUp {
                          0% { transform: scale(1); }
                          100% { transform: scale(1.18); }
                        }
                        .door.scale-up {
                          animation: scaleUp 0.18s;
                        }
                    @keyframes bounce {
                      0%   { transform: scale(1); }
                      20%  { transform: scale(1.2, 0.8); }
                      40%  { transform: scale(0.95, 1.05); }
                      60%  { transform: scale(1.15, 0.85); }
                      80%  { transform: scale(0.98, 1.02); }
                      100% { transform: scale(1); }
                    }

                    @keyframes shake {
                      0% { transform: translate(0, 0) scale(1); }
                      10%, 30%, 50%, 70%, 90% { transform: translate(-8px, 0) scale(1); }
                      20%, 40%, 60%, 80% { transform: translate(8px, 0) scale(1); }
                      100% { transform: translate(0, 0) scale(1); }
                    }

                    .door.bounce {
                      animation: bounce 0.4s;
                    }
                    .door.shake {
                      animation: shake 1.0s;
                    }
                    @keyframes pulse {
                      0% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0.7); }
                      70% { box-shadow: 0 0 0 12px rgba(255, 215, 0, 0); }
                      100% { box-shadow: 0 0 0 0 rgba(255, 215, 0, 0); }
                    }
                    .door.pulse {
                      animation: pulse 1.2s infinite;
                    }
                #loading-overlay .loading-message {
                  font-family: 'Comic Neue', Arial, sans-serif;
                  text-align: center;
                  font-size: 1em;
                  margin-bottom: 0.5em;
                  font-weight: bold;
                }
            #loading-powered {
            position: static;
            margin: 30px 0 10px 0;
            width: 100vw;
            text-align: center;
            font-size: 0.8em;
            color: #fff;
            opacity: 0.7;
            letter-spacing: 1px;
            font-family: 'Fira Mono', 'Consolas', 'Menlo', 'Monaco', monospace;
            pointer-events: none;
            }
        #loading-powered-overlay {
            position: fixed;
            bottom: 18px;
            left: 0;
            width: 100vw;
            text-align: center;
            font-size: 0.4em;
            color: #fff;
            opacity: 0.7;
            letter-spacing: 1px;
            font-family: 'Fira Mono', 'Consolas', 'Menlo', 'Monaco', monospace;
            z-index: 10000;
            pointer-events: none;
            }
        #loading-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          background: #b30000;
          color: white;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          font-size: 2em;
          z-index: 9999;
          transition: opacity 0.5s;
        }
    body {
      font-family: Arial, sans-serif;
      background: #f3f3f3 url('xmas.jpg') repeat;
      background-size: 200px 200px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px;
    }

    h1 {
      text-align: center;
      margin-top: 24px;
      margin-bottom: 8px;
      font-size: 1.4em;
      font-family: 'Comic Neue', Arial, sans-serif;
      font-weight: bold;
      color: #fff;
      text-shadow: none;
      /*text-shadow: 1px 1px 4px #ffffff, 0 0 2px #000;*/
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(4, 80px);
      grid-gap: 8px;
      margin-top: 30px;
    }

    .door {
      width: 70px;
      height: 70px;
      /* background: #b30000; */ /* original red background */
      border-radius: 8px;
      color: white;
      font-family: 'Comic Neue', Arial, sans-serif;
      display: flex;
      justify-content: flex-start;
      align-items: flex-end;
      font-size: 22px;
      cursor: pointer;
      transition: transform 0.2s;
      user-select: none;
      padding: 0 0 8px 10px;
      background-image: url('red-box3.png');
      background-size: cover;
      background-position: center;
    }

    .door.locked {
      /* background: #555; */ /* original grey background */
      background-image: url('grey-box2.png');
      background-size: cover;
      background-position: center;
      cursor: not-allowed;
    }

    .door:hover:not(.locked) {
      transform: scale(1.15);
    }

    #content {
      margin-top: 10px;
      padding: 16px;
      background: white;
      border-radius: 8px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      display: none;
    }

    #content p {
      font-family: 'Segoe UI', Arial, sans-serif;
    }

    #content h1 {
      margin-top: -8px;
      margin-bottom: -8px;
      font-size: 1.3em;
      font-family: 'Comic Neue', Arial, sans-serif;
      font-weight: bold;
      color: #000000;
      text-shadow: none;
    }

    #content img,
    #content-overlay-center img,
    #content-overlay-center video {
      width: 100%;
      border-radius: 6px;
      display: block;
      margin: 10px auto;
      object-fit: contain;
    }

    #content-overlay-center {
      position: fixed;
      top: 48%;
      left: 50%;
      transform: translate(-50%, -52%);
      margin: 0;
      padding: 32px 16px 32px 16px;
      background: white;
      border-radius: 8px;
      width: 60vw;
      max-width: 500px;
      min-width: 280px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      display: block;
      overflow-y: auto;
      max-height: 76vh;
    }
    #content-overlay-center p {
      font-family: 'Segoe UI', Arial, sans-serif;
    }
    #content-overlay-center h1 {
      margin-top: -8px;
      margin-bottom: -8px;
      font-size: 1.3em;
      font-family: 'Comic Neue', Arial, sans-serif;
      font-weight: bold;
      color: #000000;
      text-shadow: none;
    }
    /* Santa Day 6 Overlay Styles */
  #santa-overlay {
    display: none;
    position: fixed;
    z-index: 10001;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: rgba(0,0,0,0.65);
    backdrop-filter: blur(2px);
    justify-content: center;
    align-items: center;
    flex-direction: column;
  }
  #santa-overlay-top img,
  #xmas-overlay-top img {
    max-width: 280px;
    max-height: 180px;
  }
    #santa-overlay-center img,
    #xmas-overlay-center img {
      max-width: 270px;
      max-height: 270px;
      opacity: 0;
      border-radius: 12px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.18);
      background: #fff;
      padding: 8px;
    }
  #santa-overlay-bottom button,
  #xmas-overlay-bottom button {
    font-family: 'Comic Neue', Arial, sans-serif;
    font-size: 1.1em;
    padding: 10px 28px;
    background: #b30000;
    color: #fff;
    border: none;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.12);
    cursor: pointer;
    margin-bottom: 32px;
  }


  </style>
</head>

<script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js")
      .then(() => console.log("Service worker registered"))
      .catch(err => console.error("Service worker error:", err));
  }
</script>

<body>
    <!-- Snow overlay canvas -->
    <canvas id="snow-canvas" style="position:fixed;top:0;left:0;width:100vw;height:100vh;pointer-events:none;z-index:10002;"></canvas>
    <div id="loading-overlay">
    <span class="loading-message" style="font-weight:bold;">Julis Adventi Kalend√°riuma</span>
    <img src="app-icon-me.png" alt="Loading..." style="width:200px;height:200px;margin-bottom:20px;">
    <span class="loading-message" id="hihi-loading" style="font-weight:normal;"><span id="hihi-dots" style="display:inline-block;min-width:1.5em;padding-left:0;"></span></span>
    <div id="loading-powered-overlay">powered by gabo | v2025.01.02 </div>
  </div>
  <div class="title-bg"><h1>üéÑJulis Adventi Kalend√°riumaüéÑ</h1></div>
  <div class="calendar" id="calendar"></div>
  <!-- General Content Overlay (for all days except 6 and 24) -->
  <div id="content-overlay" style="display:none;position:fixed;z-index:10001;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.65);backdrop-filter:blur(2px);justify-content:center;align-items:center;flex-direction:column;">
      <div id="content-overlay-center">
        <!-- Content will be injected here -->
      </div>
      <button id="close-content-btn" style="position:fixed;bottom:32px;left:50%;transform:translateX(-50%);z-index:10002;font-family:'Comic Neue',Arial,sans-serif;font-size:1.1em;padding:10px 28px;background:#b30000;color:#fff;border:none;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.12);cursor:pointer;">Kalend√°rium</button>
  </div>
  <!-- Santa Day 6 Overlay (hidden by default) -->
  <div id="santa-overlay" style="display:none;position:fixed;z-index:10001;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.65);backdrop-filter:blur(2px);justify-content:center;align-items:center;flex-direction:column;">
    <div id="santa-overlay-top" style="width:100%;display:flex;justify-content:center;align-items:center;margin-top:32px;margin-bottom:10px;"></div>
    <div id="santa-overlay-center" style="display:flex;justify-content:center;align-items:center;min-height:180px;"></div>
    <div id="santa-overlay-bottom" style="width:100%;display:flex;justify-content:center;align-items:center;margin-top:18px;"></div>
  </div>
  <!-- Xmas Day 24 Overlay (hidden by default) -->
  <div id="xmas-overlay" style="display:none;position:fixed;z-index:10001;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.65);backdrop-filter:blur(2px);justify-content:center;align-items:center;flex-direction:column;">
    <div id="xmas-overlay-top" style="width:100%;display:flex;justify-content:center;align-items:center;margin-top:32px;margin-bottom:10px;"></div>
    <div id="xmas-overlay-center" style="display:flex;justify-content:center;align-items:center;min-height:180px;"></div>
    <div id="xmas-overlay-bottom" style="width:100%;display:flex;justify-content:center;align-items:center;margin-top:18px;"></div>
  </div>

<script>
  // Typewriter effect for 'hihi...': run two cycles
  window.addEventListener('DOMContentLoaded', () => {
    const hihiLoading = document.getElementById('hihi-loading');
    const fullText = 'hihi...';
    let cycle = 0;
    function runTypewriter() {
      let idx = 0;
      const paddedText = ' hihi...';
      // Use monospace font and a transparent span to reserve space
        hihiLoading.style.fontFamily = 'Comic Neue, Consolas, Menlo, Monaco, monospace';
        hihiLoading.style.letterSpacing = '0.04em';
        hihiLoading.style.fontWeight = 'normal';
        hihiLoading.style.fontSize = '1em';
        hihiLoading.style.display = 'block';
        hihiLoading.style.position = 'relative';
        hihiLoading.style.textAlign = 'center';
        hihiLoading.style.width = '8.5ch'; // width for ' hihi...'
        hihiLoading.style.margin = '0 auto';
        hihiLoading.innerHTML = `<span id="hihi-placeholder" style="opacity:0;font-size:0.85em;font-weight:normal;">${paddedText}</span><span id="hihi-type" style="font-weight:normal;font-size:0.85em;position:absolute;left:0;top:0;width:100%;text-align:center;"></span>`;
        const typeSpan = document.getElementById('hihi-type');
      let typeInterval = setInterval(() => {
        idx++;
        typeSpan.textContent = paddedText.slice(0, idx);
        if (idx === paddedText.length) {
          clearInterval(typeInterval);
          cycle++;
          if (cycle < 2) {
            setTimeout(runTypewriter, 400); // short pause before next cycle
          } else {
            setTimeout(() => {
              const overlay = document.getElementById('loading-overlay');
              overlay.style.opacity = 0;
              // Keep #loading-powered visible during fade-out
              const powered = document.getElementById('loading-powered-overlay');
              if (powered) powered.style.opacity = 1;
              setTimeout(() => {
                overlay.style.display = 'none';
                if (powered) powered.style.opacity = 0.7; // restore default after fade
              }, 300);
            }, 800);
          }
        }
      }, 180);
    }
    runTypewriter();
  });
// Simple snow effect overlay
window.addEventListener('DOMContentLoaded', () => {
  const canvas = document.getElementById('snow-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  let width = window.innerWidth;
  let height = window.innerHeight;
  function resizeCanvas() {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;
  }
  resizeCanvas();
  window.addEventListener('resize', resizeCanvas);
  // Snowflake properties
  const flakes = [];
  const flakeCount = Math.max(60, Math.floor(width * height / 3500));
  for (let i = 0; i < flakeCount; i++) {
    flakes.push({
      x: Math.random() * width,
      y: Math.random() * height,
      r: 1.2 + Math.random() * 2.2,
      d: 0.7 + Math.random() * 1.3,
      a: Math.random() * Math.PI * 2,
      speed: 0.6 + Math.random() * 1.2
    });
  }
  function drawSnow() {
    ctx.clearRect(0, 0, width, height);
    ctx.save();
    ctx.globalAlpha = 0.85;
    ctx.fillStyle = '#fff';
    flakes.forEach(f => {
      ctx.beginPath();
      ctx.arc(f.x, f.y, f.r, 0, Math.PI * 2);
      ctx.fill();
    });
    ctx.restore();
  }
  function updateSnow() {
    for (let f of flakes) {
      f.y += f.speed * f.d;
      f.x += Math.sin(f.a) * 0.6;
      f.a += 0.01 + Math.random() * 0.01;
      if (f.y > height + 4) {
        f.y = -4;
        f.x = Math.random() * width;
      }
      if (f.x > width + 4) f.x = -4;
      if (f.x < -4) f.x = width + 4;
    }
  }
  function animateSnow() {
    updateSnow();
    drawSnow();
    requestAnimationFrame(animateSnow);
  }
  animateSnow();
});
</script>

<script>
    const contentData = {
      1: { title: "1. Szia Julis!:)", text: "√údv az adventi kalend√°riumodban!\nMinden napra jut majd egy kis meglepet√©s, hihi.\n Az els≈ë maga az applik√°ci√≥, rem√©lem tetszik:)\nPusziii!!!ü•∞", image: "coding.jpg", link: "", video: "" },
      2: { title: "2. √úgyi-b√ºgyi vagy...", text: "...hogy ma is visszat√©rt√©l:)!\n Jutalmad egy kis k√°v√©p√©nz-t√°mogat√°s (√≠gy h√≥ v√©ge fel√© k√∂zeledve), hogy nyitva tudd tartani ma a szemeidet √≥r√°n. Checkold a Revolutod!", image: "coffee.png", link: "", video: "" },
      3: { title: "3. 3 h√≥napja...", text: "...tal√°lkoztunk el≈ësz√∂r kettesben!:) Durva, mennyi minden t√∂rt√©nt az√≥ta:)\n A havi kis bor√≠t√©kod nem marad el, majd odaadom, ha tal√°lkozunk!:)\nUi.: Ma este egy g√∂rg≈ëz√©s?üòé", image: "0903.jpg", link: "", video: "" },
      4: { title: "4. J√≥ reggelt!", text: "√úgyes legy√©l ma a susuban!:)", image: "", link: "", video: "wakey.mp4" },
      5: { title: "5. Grafilogika:)", text: "Ma egy kis feladv√°nyt kapsz, rem√©lem ki tudod sz√≠nesben nyomtatni.\n Viel Spa√ü!:)<br><a href='https://drive.google.com/file/d/1hQnBsPC27ZBde7qkPaNAs_L4dANv0pTG/view?usp=drive_link' target='_blank'>Nyomtat√°s</a>", image: "nonogramm.png", link: "", video: "" },
      6: { title: "6. Ho-ho-ho-hooo!üéÖ", text: "Rem√©lem j√≥l viselkedt√©l az √©vben, kedves Julis!\nSiker√ºlt megoldani a grafilogik√°t?:)", image: "", link: "", video: "" },
      7: { title: "7. Nagyon nagyon!", text: 'Bocsi, most r√°mj√∂tt. Legyen sz√©p napod! Szeretlek!‚ù§Ô∏è <br><img src="collage.jpg" style="max-width:100%;border-radius:8px;margin:10px 0;" /><br><iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/track/39C8c4BmdRAHLrj79mCsU1?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>', image: "", link: "", video: "" },
      8: { title: "8. Bolond√≥ra!", text: "Julis, ma sem maradhat el a bolond√≥ra! Bukfencezgess p√°rat a lak√°sban:) Ha k√©sz√ºl r√≥la vide√≥, sz√≠vesen veszem:)!", image: "bukfenc.gif", link: "", video: "" },
      9: { title: "9. Egy kis motiv√°ci√≥ reggelre!", text: "Gyer√ºnk Julis, √ºgyes leszel ma!ü§ò\nRopjad neki!", image: "", link: "", video: "fish.mp4" },
      10: { title: "10. A mai meglepet√©s pedig...", text: "... √©n leszek!:)\nNa j√≥, ennyire az√©rt nem kell repdesned az √∂r√∂mt≈ël. V√©gre √∫jra tal√°lkozunk, v√°√°√°√°√°√°√°√°√°√°!", image: "lederhose.jpg", link: "", video: "" },
      11: { title: "11. Fut√°√°√°s", text: "Julisom, ma olyan r√©szt√°vokat futunk, amilyet csak szeretn√©l;)", image: "run.jpeg", link: "", video: "" },
      12: { title: "12. Kar√°csonyi v√°s√°r", text: "Ma v√°laszthatsz b√°rmit a kar√°csonyi v√°s√°rban, ami megtetszik!:)", image: "christkindl.jpg", link: "", video: "" },
      13: { title: "13. Setem√©ny", text: "Ma vend√©gem vagy egy s√ºtire. Pusszancs!", image: "suti.jpg", link: "", video: "" },
      14: { title: "14. B√∫cs√∫:(", text: "K√°r, hogy m√©szü•∫ De hamarosan √∫jra egy√ºtt!‚ò∫Ô∏è\n B√∫cs√∫z√≥ul megiszunk ma egy forralt bort a v√°rosban, mit sz√≥lsz?:)", image: "gluhwein.jpg", link: "", video: "" },
      15: { title: "15. Hihi!", text: "A mai meglepi egy mozijegy!\nMikor megy√ºnk???üòè", image: "zootopia.jpg", link: "", video: "" },
      16: { title: "16. Hupsz...", text: "Julisom, az √©let nem mindig habostorta! N√©ha meg kell √°llni, √©s √©rt√©kelni mindazt, ami megadatott. Nem szabad telhetetlennek lenni.", image: "hupsz.jpg", link: "", video: "" },
      17: { title: "17. J√≥ √©jszak√°t!", text: 'Ma est√©re k√ºld√∂k neked egy kis szeretetcsomagotü´∂<br>Sz√©p √°lmokat!<br><img src="sleep.jpg" style="display:block;margin:10px auto;max-width:100%;border-radius:8px;" /><br><iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/track/0okYToJLGAT1OPVMXM4Gjx?utm_source=generator" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>', image: "", link: "", video: "" },
      18: { title: "18. Kitart√°st...", text: "...m√©g az utols√≥ napokra:)\nBerci is szeretett volna √ºzenni a kalend√°riumban neked, ≈ët kapcsolom most:)", image: "berci.jpg", link: "", video: "" },
      19: { title: "19. Titkos recept", text: "Ma a paszulyleves receptj√©t kapod t≈ëlem, csak hogy ha megszoruln√°l esetleg, √©s kifogyna minden a m√©lyh≈±t≈ëb≈ël...\n\nHozz√°val√≥k 4 szem√©lyre\n50 dkg sz√°razPASZULY !!! (feh√©r vagy tarka)\n1 fej v√∂r√∂shagyma\n1 sz√°l MUROK !!!\n1 sz√°l petrezselyemgy√∂k√©r\nkev√©s zellergy√∂k√©r\n3-4 db bab√©rlev√©l\n1 kan√°l ecetes t√°rkony\n20 dkg f√ºst√∂lt kolb√°sz\n2 kan√°l zs√≠r (vagy olaj)\n2 kan√°l liszt\n1 kk. pirospaprika\n3 dl zs√≠ros tej\ns√≥, bors\nJ√≥ √©tv√°gyat!", image: "cook.jpg", link: "", video: "paszuly.mp4" },
      20: { title: "20. Meglepet√©s", text: "Szio! Rem√©lem ma tal√°lkozunk, √©s odaadhatom a cuki meglepet√©semet:)", image: "gift.png", link: "", video: "" },
      21: { title: "21. Hal√≥!", text: "Rem√©lem ma veled √©bredek!:)\n Mit sz√≥ln√°l hozz√°, ha elmenn√©k ma egy j√≥ helyre eb√©delni?ü§å", image: "salve.jpg", link: "", video: "" },
      22: { title: "22. Eml√©keztet≈ë...", text: "...arra, hogy mennyire sziper-szuper √ºgyes vagy!üèÜ\nB√ºszke lehetsz magadra!:)\n√ân az vagyok r√°d!ü•π", image: "ranglista.png", link: "", video: "" },
      23: { title: "23. Eml√©keztet≈ë 2...", text: "...arra, hogy n√°lad t√©nyleg!\n√ñlellek, puszillak, szeretlek!‚ù§Ô∏è\nKellemes √ºnnepeket!", image: "julis.jpg", link: "", video: "nalad-tenyleg.mp4" },
      24: { title: "24. Boldog kar√°csonyt!", text: "Legyen sz√©p napod ma a csal√°doddal, Julis!üéÅ\nRem√©lem tetszett ez a kis kalend√°rium.\n√ân G√°bor voltam, a te kis g√∂mb√∂c√∂d, pusziii!!!ü•∞", image: "bercixmas.jpg", link: "", video: "" },
    };

  // Customizable: set how many doors can be opened (0 = use normal logic, 1-24 = open up to that day)
  const OPEN_DAYS = 24; // e.g., set to 5 to open first 5 days, 24 to open all, 0 for normal logic
  // DEV mode: set to true to unlock all doors
  const DEV = false; // set to true for development
  const today = new Date();
  let currentDay;
  if (OPEN_DAYS > 0) {
    currentDay = OPEN_DAYS;
  } else if (DEV) {
    currentDay = 24;
  } else {
    // If today is after December 24, 2025, open all doors
    const unlockDate = new Date(2025, 11, 24, 23, 59, 59); // December is month 11
    if (today > unlockDate) {
      currentDay = 24;
    } else {
      // Open doors up to today's date if in the current month, else 0
      const calendarMonth = today.getMonth(); // Use current month
      currentDay = (today.getMonth() === calendarMonth ? today.getDate() : 0);
    }
  }

  const calendar = document.getElementById("calendar");
  const contentOverlay = document.getElementById("content-overlay");
  const contentOverlayCenter = document.getElementById("content-overlay-center");
  const contentOverlayBottom = document.getElementById("content-overlay-bottom");

  function showLockedMessage(day) {
    alert("H√©k√°s! Csak ne olyan hevesen! Legyen mi√©rt v√°rni a holnapot is!;)üéÅ");
  }

  for (let day = 1; day <= 24; day++) {
    const door = document.createElement("div");
    door.className = "door";
    door.textContent = day;

    const openedKey = 'advent-opened-' + day;
    const isOpened = localStorage.getItem(openedKey) === '1';

    if (day > currentDay) {
      door.classList.add("locked");
      door.addEventListener("click", () => {
        door.classList.add('shake');
        if (window.navigator.vibrate) window.navigator.vibrate(350);
        setTimeout(() => {
          door.classList.remove('shake');
          showLockedMessage(day);
        }, 350);
      });
    } else {
      door.classList.add('available');
      // Only the current day's box pulses until opened
      if (day === currentDay && !isOpened) {
        door.classList.add('pulse');
      }
      door.addEventListener("click", () => {
        // Custom vibration pattern: triple pulse
        if (window.navigator.vibrate) window.navigator.vibrate([200, 100, 200, 100, 200]);
        door.classList.remove('pulse');
        door.classList.add('scale-up');
        setTimeout(() => {
          door.classList.remove('scale-up');
          door.classList.add('bounce');
          setTimeout(() => {
            door.classList.remove('bounce');
            setTimeout(() => {
              // Toggle open door content for any available day (now using overlay)
              const expectedHtml = `<h1>${contentData[day].title || (day + '. nap')}</h1><p>${contentData[day].text.replace(/\n/g, '<br>')}</p>` +
                (contentData[day].image ? `<img src="${contentData[day].image}" style="display:block;margin:10px auto;">` : '') +
                (contentData[day].link ? `<p><a href="${contentData[day].link}" target="_blank">Open link</a></p>` : '') +
                (contentData[day].video ? `<video controls src="${contentData[day].video}" style="width:100%"></video>` : '');
              if (contentOverlay.style.display === "flex" && contentOverlayCenter.innerHTML.trim() === expectedHtml.trim()) {
                contentOverlay.style.display = "none";
              } else {
                openDoor(day);
                localStorage.setItem(openedKey, '1');
              }
            }, 400); // Extra 0.4s delay after bounce
          }, 300); // Wait for bounce animation to finish
        }, 300); // Wait for scale-up animation to finish
      });
    }

    calendar.appendChild(door);
  }

  function openDoor(day) {
    const data = contentData[day];
    // Special content for day 6
    if (day === 6) {
      document.getElementById('calendar').style.filter = 'blur(2px)';
      contentOverlay.style.display = 'none';
      const overlay = document.getElementById('santa-overlay');
      overlay.style.display = 'flex';
      document.getElementById('santa-overlay-top').innerHTML = '<div style="display:flex;flex-direction:column;align-items:center;width:100%"><h1 style="color:#fff;text-shadow:1px 1px 4px #b30000,0 0 2px #000;font-family:\'Comic Neue\',Arial,sans-serif;font-size:2em;margin:0 0 8px 0;">Boldog Mikul√°st!</h1><img src="santa-reindeer.gif" alt="Santa Reindeer"></div>';
      document.getElementById('santa-overlay-center').innerHTML = '<img id="santa-claus-img" src="santa-claus.png" alt="Santa Claus">';
      document.getElementById('santa-overlay-bottom').innerHTML = `
        <div style="display:flex;flex-direction:column;align-items:center;width:100%;">
          <button id="juhuuu-btn">juhuuuu!!!</button>
            <button id="santa-fake-btn" style="margin-top:-20px;background:#888;color:#fff;font-family:'Comic Neue',Arial,sans-serif;font-size:1em;padding:8px 18px;border:none;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.10);cursor:pointer;">A Mikul√°s nem is l√©tezik...</button>
        </div>
      `;
      setTimeout(() => {
        const santaImg = document.getElementById('santa-claus-img');
        if (santaImg) {
          santaImg.style.opacity = 1;
          santaImg.animate([
            { transform: 'scale(0.2)' },
            { transform: 'scale(1.08)' },
            { transform: 'scale(0.94)' },
            { transform: 'scale(1.08)' },
            { transform: 'scale(0.94)' },
            { transform: 'scale(1.08)' },
            { transform: 'scale(0.94)' },
            { transform: 'scale(1.05)' },
            { transform: 'scale(0.96)' },
            { transform: 'scale(1)' }
          ], {
            duration: 1800,
            easing: 'cubic-bezier(.45,0,.55,1)',
            fill: 'forwards'
          });
        }
      }, 100);
      setTimeout(() => {
        const btn = document.getElementById('juhuuu-btn');
        if (btn) {
          btn.onclick = () => {
            document.getElementById('santa-overlay').style.display = 'none';
            document.getElementById('calendar').style.filter = '';
            // Show content overlay for day 6
            let html = `<h1>${contentData[6].title || '6. nap'}</h1><p>${contentData[6].text.replace(/\n/g, '<br>')}</p>`;
            contentOverlayCenter.innerHTML = html;
            contentOverlay.style.display = 'flex';
            document.getElementById('close-content-btn').onclick = () => {
              contentOverlay.style.display = 'none';
            };
            };
        }
        // Add handler for the "A Mikul√°s nem is l√©tezik" button
        const fakeBtn = document.getElementById('santa-fake-btn');
        if (fakeBtn) {
          fakeBtn.onclick = () => {
            alert("Most mi√©rt kell mindent elrontani?:(\nNa puszi...");
            setTimeout(() => {
              window.close();
            }, 300);
          };
        }
      }, 200);
      return;
    }
    // Special content for day 24
    if (day === 24) {
      document.getElementById('calendar').style.filter = 'blur(2px)';
      contentOverlay.style.display = 'none';
      const overlay = document.getElementById('xmas-overlay');
      overlay.style.display = 'flex';
      document.getElementById('xmas-overlay-top').innerHTML = '<div style="display:flex;flex-direction:column;align-items:center;width:100%"><h1 style="color:#fff;text-shadow:1px 1px 4px #b30000,0 0 2px #000;font-family:\'Comic Neue\',Arial,sans-serif;font-size:2em;margin:0 0 8px 0;">Boldog kar√°csonyt!</h1><img src="lights2.gif" alt="Christmas Lights"></div>';
      document.getElementById('xmas-overlay-center').innerHTML = '<img id="xmas-img" src="xmas.png" alt="Christmas">';
      document.getElementById('xmas-overlay-bottom').innerHTML = '<button id="xmas-btn">juhuuuu!!!</button>';
      setTimeout(() => {
        const xmasImg = document.getElementById('xmas-img');
        if (xmasImg) {
          xmasImg.style.opacity = 1;
          xmasImg.animate([
            { transform: 'scale(0.2)' },
            { transform: 'scale(1.08)' },
            { transform: 'scale(0.94)' },
            { transform: 'scale(1.08)' },
            { transform: 'scale(0.94)' },
            { transform: 'scale(1.08)' },
            { transform: 'scale(0.94)' },
            { transform: 'scale(1.05)' },
            { transform: 'scale(0.96)' },
            { transform: 'scale(1)' }
          ], {
            duration: 1800,
            easing: 'cubic-bezier(.45,0,.55,1)',
            fill: 'forwards'
          });
        }
      }, 100);
      setTimeout(() => {
        const btn = document.getElementById('xmas-btn');
        if (btn) {
          btn.onclick = () => {
            document.getElementById('xmas-overlay').style.display = 'none';
            document.getElementById('calendar').style.filter = '';
            // Show content overlay for day 24
            let html = `<h1>${contentData[24].title || '24. nap'}</h1><p>${contentData[24].text.replace(/\n/g, '<br>')}</p>`;
            if (contentData[24].image) html += `<img src="${contentData[24].image}" style="display:block;margin:10px auto;">`;
            if (contentData[24].link) html += `<p><a href="${contentData[24].link}" target="_blank">Open link</a></p>`;
            if (contentData[24].video) html += `<video controls src="${contentData[24].video}" style="width:100%"></video>`;
            contentOverlayCenter.innerHTML = html;
            contentOverlay.style.display = 'flex';
            document.getElementById('close-content-btn').onclick = () => {
              contentOverlay.style.display = 'none';
            };
            };
        }
      }, 200);
      return;
    }
    // Default content for other days (now as overlay)
    let html = `<h1>${data.title || (day + '. nap')}</h1><p>${data.text.replace(/\n/g, '<br>')}</p>`;
    if (data.image) html += `<img src="${data.image}" style="display:block;margin:10px auto;width:100%;height:auto;">`;
    if (data.link) html += `<p><a href="${data.link}" target="_blank">Open link</a></p>`;
    if (data.video) html += `<video controls src="${data.video}" style="width:100%"></video>`;
    contentOverlayCenter.innerHTML = html;
    contentOverlay.style.display = "flex";
    document.getElementById('close-content-btn').onclick = () => {
      contentOverlay.style.display = 'none';
    };
            };
</script>
    <div id="loading-powered" style="position:fixed;bottom:8px;left:0;width:100vw;text-align:center;font-size:0.8em;color:#fff;opacity:0.7;letter-spacing:1px;font-family:'Fira Mono','Consolas','Menlo','Monaco',monospace;pointer-events:none;z-index:100;">powered by gabo | v2025.01.02 </div>
</body>
</html>
